<script>
async function loadMessages() {
  const container = document.getElementById("messages");
  container.innerHTML = "<p>Loading messages...</p>";

  try {
    const res = await fetch("/.netlify/functions/get-guestbook");
    if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);

    const messages = await res.json();

    if (messages.length === 0) {
      container.innerHTML = "<p>No messages yet. Be the first to sign! ðŸŽ‰</p>";
      return;
    }

    container.innerHTML = "";
    messages.forEach(msg => {
      const div = document.createElement("div");
      div.className = "message";
      div.innerHTML = `
        <p><strong>${msg.data.name}</strong> says:</p>
        <p>${msg.data.message}</p>
        <hr>
      `;
      container.appendChild(div);
    });

  } catch (err) {
    container.innerHTML = `<p>Failed to load messages: ${err.message}</p>`;
  }
}

// Load messages when the page loads
loadMessages();
</script>
